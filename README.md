# Mamma-Tumor-Classifier-2-Xray
***
## Абстракт
Этот проект посвящен построению и оценке моделей глубокого обучения для классификации ультразвуковых снимков молочной железы на три категории: доброкачественные (benign), злокачественные (malignant) и нормальные (normal). В качестве основы используется датасет BUSI (Breast Ultrasound Images Dataset).

Классификатор УЗИ-снимков женской груди на наличие новообразований(злокачественных и доброкачественных). Фиброаденом(интраканаликулярных,периканаликулярных) и Рака молочной железы. 
***
## Описание проекта
Цель проекта - разработать эффективный классификатор, который мог бы помочь в диагностике рака молочной железы на основе УЗИ-снимков. В рамках проекта реализованы следующие шаги:
1.  **Обработка данных:** Загрузка, предварительная обработка (преобразование в оттенки серого), визуализация и разделение датасета BUSI.
2.  **Аугментация данных:** Применение техник аугментации для обучающей выборки для повышения обобщающей способности моделей.
3.  **Адаптация моделей:** Использование трех предобученных архитектур сверточных нейронных сетей (ResNet18, VGG16, MobileNetV2) и их адаптация для задачи классификации одноканальных изображений на 3 класса.
4.  **Обучение моделей:** Обучение адаптированных моделей на подготовленном датасете с использованием PyTorch.
5.  **Оценка моделей:** Сравнение производительности моделей на тестовой выборке с использованием метрик: Accuracy, Precision, Recall, F1-score, ROC-AUC и Confusion Matrix.
6.  **Сохранение лучшей модели:** Сохранение весов наилучшей модели для дальнейшего использования.

## Датасет
ПОЛНЫЙ ДАТАСЕТ НЕ ЗАПУШИЛ! - Поищите на Kagle
Проект использует датасет **Dataset_BUSI_with_GT**. Ожидается, что датасет будет находиться в корневой директории проекта в папке `Dataset_BUSI_with_GT` и иметь следующую структуру:
## **Project Structure**  
```bash
Parkinson-Test_Classifier/
Dataset_BUSI_with_GT/
├── benign/
│ ├── benign (1).png
│ ├── benign (1)_mask.png
│ └── ...
├── malignant/
│ ├── malignant (1).png
│ ├── malignant (1)_mask.png
│ └── ...
└── normal/
├── normal (1).png
├── normal (1)_mask.png
└── ...
```
## Требования

*   Python 3.x
*   PyTorch
*   TorchVision
*   OpenCV (cv2)
*   NumPy
*   Matplotlib
*   Scikit-learn
*   Pillow (PIL)

Рекомендуется создать виртуальное окружение и установить зависимости из файла `requirements.txt` (необходимо создать этот файл):
```bash
pip install -r requirements.txt
```

## Для работы с моделями рекомендуется использовать GPU с поддержкой CUDA:
Сам проект выполнялся на 80 тензорных ядер и 2560 CUDA ядер.

***

## Запуск
1. Клонируйте Репозиторий
2. Установите зависимости
```bash
pip install -r requirements.txt
```
3. Добавтье изображение рентгена молочной железы  в папку _Image_Xray_mamma_ в png формате. Назовите изображение _test_image_. Изменить данные переменные можно в файле In Line 109 _src/main.ru_
4. Запустите _main.ru_

## Реализованные модели

Были адаптированы и обучены следующие предобученные модели:

1. ResNet18: Первый сверточный слой изменен для приема 1-канальных (grayscale) изображений. Последний полносвязный слой изменен для классификации на 3 класса.

2. VGG16: Аналогично, первый сверточный слой и классификатор адаптированы.

3. MobileNetV2: Первый сверточный слой и классификатор адаптированы.

**Результаты**: 

Все модели показали точность (Accuracy) выше требуемого порога в 0.70, и даже выше желаемого порога в 0.80.

**MobileNetV2** показала наилучшую общую точность (89.74%) и ROC-AUC (0.9548).

**VGG16** также показала высокую производительность с точностью 88.46%.

**ResNet18** немного уступила, но все равно продемонстрировала хороший результат (84.62%).

Наиболее важным для медицинской диагностики является класс malignant. Все модели показали хороший Recall и Precision для этого класса, причем MobileNetV2 и VGG16 были несколько лучше.

Анализ confusion matrix показывает, что основная путаница происходит между классами benign и malignant.

<details>
<summary><b>Нажмите, чтобы посмотреть _confusion matrix_</b></summary>
![Confusion matrix](./README/ConfusionMatrix_MobileNetV2.png)
</details>

## **Общая структура проекат**  
```bash
